Assignment 2

q1) Create the table Member, Books and Issue without any constraints as
mentioned in the schema description above.

mysql> create table members
    ->      ( member_id int ,
    ->      member_name varchar(30),
    ->      member_address varchar(40),
    ->      acc_open_date date,
    ->      membership_type varchar(20),
    ->      fees_paid int,
    ->      max_books_allowed int,
    ->      penalty_amount decimal(7,2));

mysql> CREATE TABLE book (
    ->     book_no INT,
    ->     book_name VARCHAR(30),
    ->     author_name VARCHAR(30),
    ->     cost DECIMAL(7,2),
    ->     category CHAR(10)
    -> );


mysql> create table issuebook(
    -> lib_issue_id int,
    -> book_no int,
    -> member_id int,
    -> issue_date date,
    -> return_date date);

q2) View the structure of the tables.

mysql> show tables;

q3) Drop the Member table
mysql> drop table members;

q4)Create the table Member again as per the schema description with the
following constraints. 

mysql> create table member(
    -> member_id int primary key,
    -> membership_type enum('lifetime','annual','half yearly','quarterly'));

q5) Modify the table Member increase the width of the member name to 30
characters.
     mysql> alter table member
    -> modify member_name varchar(50);
q6) Add a column named as Reference of Char(30) to Issue table.

mysql> alter table issuebook
    -> add reference char(30);  
q7)Delete/Drop the column Reference from Issue.

mysql> alter table issuebook
    -> drop column reference

q8) Rename the table Issue to Lib_Issue.

mysql> rename table issuebook to lib_issue;

q9) Insert following data in table Member
 mysql> INSERT INTO Members (
    -> Member_Id,
    ->     Member_Name,
    ->     Member_Address,
    ->     Acc_Open_Date,
    ->     Membership_Type,
    ->     Fees_Paid,
    ->     Max_Books_Allowed,
    ->     Penalty_Amount
    -> )
    -> VALUES (
    ->     1, 'Richa Sharma', 'Pune', '2005-12-10', 'Lifetime', 25000, 5, 50
    -> );

mysql> INSERT INTO Members (
    ->  Member_Id, Member_Name, Member_Address, Acc_Open_Date,
    ->     Membership_Type, Fees_Paid, Max_Books_Allowed, Penalty_Amount
    -> )
    -> VALUES (
    ->     2, 'Garima Sen', 'Pune', CURDATE(),
    ->     'Annual', 1000, 3, NULL
    -> );

q10).Insert at least 5 records with suitable data.
 mysql> insert into bookks
    -> (Book_Id, Title, Author, Genre, Published_Year, Price, Available_Copies
    -> ) VALUES
    -> (1, 'The Silent Patient', 'Alex Michaelides', 'Thriller', 2019, 499.00, 3),
    -> (2, 'Atomic Habits', 'James Clear', 'Self-help', 2018, 699.00, 5),
    -> (3, 'Sapiens', 'Yuval Noah Harari', 'History', 2011, 799.00, 2),
    -> (4, 'The Alchemist', 'Paulo Coelho', 'Fiction', 1988, 350.00, 4),
    -> (5, 'Deep Work', 'Cal Newport', 'Productivity', 2016, 599.00, 6);

q11)Modify the column Member_name. Decrease the width of the member
name to 20 characters. (If it does not allow state the reason for that)

mysql> ALTER TABLE Members
    -> MODIFY member_name VARCHAR(20);

q12) Try to insert a record with Max_Books_Allowed = 110, Observe the
error that comes.

mysql> create table memberse(
    -> Member_ID INT PRIMARY KEY,
    ->     Member_Name VARCHAR(50),
    ->     Max_Books_Allowed INT,
    ->     CHECK (Max_Books_Allowed <= 100) 
    -> );

q13)Generate another table named Member101 using a Create command
along with a simple SQL query on member table.

      mysql> CREATE TABLE Member101 AS
    -> SELECT Member_ID, Member_Name, Max_Books_Allowed
    -> FROM Member;
q14) Add the constraints on columns max_books_allowed and penalty_amt
as follows
a. max_books_allowed < 100
b. penalty_amt maximum 1000
Also give names to the constraints.

mysql> create table memberss101(
    -> Member_ID INT PRIMARY KEY,
    ->     Member_Name VARCHAR(50),
    ->     Max_Books_Allowed INT,
    ->     Penalty_Amt DECIMAL(10,2),
    ->     CONSTRAINT chk_max_books CHECK (Max_Books_Allowed < 100),
    ->     CONSTRAINT chk_penalty_amt CHECK (Penalty_Amt <= 1000)
    -> );

q15)Drop the table books.
mysql> drop table book;

q16) Create table Books again as per the schema description with the
following constraints.
a. Book_No – Primary Key
b. Book_Name – Not Null
c. Category – System, Fiction, Database, RDBMS, Others.

mysql> create table book (
    -> book_no int primary key,
    -> book_name varchar(20) not null,
    -> category enum('system','fiction','database','rdbms','other') not null);

q17)Insert data in Book table as follows:

  insert into Pbook(
    ->      book_no,book_name,author,cost,category)
    ->     values
    ->      (101,'Let us C','Denis Ritchie',450,'System'),
    ->      (102,'Oracle - complete ref','Loni',550,'Database'),
    ->      (103,'Master SQL','Loni',250,'Database'),
    ->     (104,'PL SQL-ref','scott Urman',750,'Database');

q18) Insert more records in Book table.
mysql> alter table pbook
    -> add published_year int ;

q19) View the data in the tables using simple SQL query.

mysql> select * from pbook;

q20)Insert into Book following data.
mysql> insert into pbook(
    -> book_no,book_name,author,cost,category)
    -> values
    -> (105,'National Geographic','adis scott',1000,'science');
 
q21)Rename the table Lib_Issue to Issue.
mysql> rename table lib_issue to issue;

q22)Drop table Issue.
mysql> drop table issue;

q23)As per the given structure Create table Issue again with following
constraints.

 Lib_Issue_Id-Primary key
 Book_No- foreign key
 Member_id - foreign key
 Issue_date
 Return_date

 mysql> create table issue (
    -> issueb_id int primary key,
    -> book_no int,
    -> member_id int,
    -> issue_date date,
    -> return_date date,
    -> foreign key (book_no) references book(book_no),
    -> foreign key (member_id) references members(member_id));

q24)Insert following data into Issue table.
mysql> insert into issue(
    -> lib_issue_id,book_no,member_id,issue date)
    -> values
    -> (7001,101,1,10-dec-06),
    -> (7002,102,2,25-dec-06),
    -> (7003,104,1,15-jan-06),
    -> (7004,101,1,04-jul-06),
    -> (7005,104,2,15-nov-06),
    -> (7006,101,3,18-feb-06);

q25)Remove the constraints on Issue table
mysql> show create table issue;
ALTER TABLE issue DROP PRIMARY KEY;

q26)Insert a record in Issue table. The member_id should not exist in
  member table. 
mysql> select member_id from member;

q27)Now enable the constraints of Issue table. Observe the error

mysql> alter table issue
    -> add constraint fk_issue_member
    -> foreign key(member_id) references member (member_id);

q28)Delete the record inserted at Q-27) and enable the constraints.
mysql> DELETE FROM member WHERE member_id = 999;

q29)Try to delete the record of member id 1 from member table and
observe the error .
DELETE FROM member WHERE member_id = 1;
 
q30)View the data and structure of all the three tables Member,
Issue, Book.
 
mysql> desc member;
mysql>desc issue;
mysql>desc book;

mysql> show create table member;
mysql> show create table issue;
mysql> show create table book;

q31)Modify the Return_Date of 7004,7005 to 15 days after the
Issue_date.

mysql>UPDATE Book_Issues
SET Return_Date = DATE_ADD(Issue_date, INTERVAL 15 DAY)
WHERE ID IN (7004, 7005);

q32)Remove all the records from Issue table where member_ID is 1
and Issue date in before 10-Dec-06.

mysql> DELETE FROM issue
    -> WHERE member_ID = 1
    ->   AND Issue_Date < '2006-12-10';

q33)Remove all the records from Book table with category other
than RDBMS and Database.

mysql> DELETE FROM Book
    -> WHERE category NOT IN ('RDBMS', 'Database');

q34)Remove the table Member.

mysql> DROP TABLE Member;

q35)Remove the table Book.

mysql>DROP TABLE Book;
